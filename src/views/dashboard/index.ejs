<nav>
    <a href="/">Accueil</a>
    <a href="/api-docs" target="_blank">Documentation API</a>
    <a href="/auth/logout">Se déconnecter</a>
</nav>

<h1>Tableau de bord</h1>

<section>
    <h2>Utilisateur connecté</h2>
    <p>Nom: <%= user?.username || '-' %>
    </p>
    <p>Email: <%= user?.email || '-' %>
    </p>
</section>

<section>
    <h2>Date du jour</h2>
    <p><time datetime="">
            <%= today.toLocaleDateString('fr-FR') %>
        </time></p>
</section>

<section>
    <h2>Réservations en cours</h2>

    <% if (typeof error !=='undefined' && error) { %>
        <p style="color:red;">
            <%= error %>
        </p>
        <% } %>

            <% if (!reservations || reservations.length===0) { %>
                <p>Aucune réservation en cours.</p>
                <% } else { %>
                    <table border="1" cellpadding="6" cellspacing="0">
                        <thead>
                            <tr>
                                <th>Catway</th>
                                <th>Client</th>
                                <th>Bateau</th>
                                <th>Début</th>
                                <th>Fin</th>
                                <th colspan="3">options</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% reservations.forEach(r=> { %>
                                <tr>
                                    <td>
                                        <%= r.catwayNumber %>
                                    </td>
                                    <td>
                                        <%= r.clientName %>
                                    </td>
                                    <td>
                                        <%= r.boatName %>
                                    </td>
                                    <td>
                                        <%= new Date(r.startDate).toLocaleDateString('fr-FR') %>
                                    </td>
                                    <td>
                                        <%= new Date(r.endDate).toLocaleDateString('fr-FR') %>
                                    </td>
                                    <td><a href="/catways/<%= r.catwayNumber %>/reservations/<%= r._id %>">Voir</a></td>
                                    <td><a
                                            href="/catways/<%= r.catwayNumber %>/reservations/<%= r._id %>/edit">Modifier</a>
                                    </td>
                                    <td>
                                        <form
                                            action="/catways/<%= r.catwayNumber %>/reservations/<%= r._id %>?_method=DELETE"
                                            method="DELETE" style="display:inline;">
                                            <button type="submit"
                                                onclick="return confirm('Supprimer cette réservation ?')">Supprimer</button>
                                        </form>
                                    </td>
                                </tr>
                                <% }) %>
                        </tbody>
                    </table>
                    <% } %>
</section>